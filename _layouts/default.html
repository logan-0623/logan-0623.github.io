<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'en' }}">
<head>
  {%- include head.html -%}
  <link rel="stylesheet" href="{{ '/assets/css/transition.css' | relative_url }}">
  <link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.css" />
  <link href="https://fonts.googleapis.com/css?family=Inter:400,600,700&display=swap" rel="stylesheet">
  <style>
    /* body.fade { opacity: 0; transition: opacity 0.5s; } */
    /* body.fade.fade-in { opacity: 1; } */
    .loader {
      position: fixed; z-index: 9999; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(10,10,10,0.6); display: flex; justify-content: center; align-items: center;
      backdrop-filter: blur(4px); transition: opacity 0.3s;
    }
    .loader.hidden { opacity: 0; pointer-events: none; }
    #transition-bar { width: 60vw; height: 6px; border-radius: 3px; background: linear-gradient(90deg, #934B43, #b4dced 60%); }
    /* 可选：transition-bar的动画也可以全交给js控制 */
  </style>
</head>
<body>
  <!-- Loader-->
  <div class="loader hidden" id="page-loader">
    <div id="page-brush"></div>
    <div id="transition-bar"></div>
  </div>

  <!-- 主题切换按钮等其它组件不变 -->
  <button class="theme-switch" onclick="toggleTheme()">
    <span class="theme-icon">🎴</span>
  </button>

  <!-- 平滑滚动主容器 -->
  <div data-scroll-container>
    {%- include header.html -%}
    <main class="page-content" aria-label="Content" data-scroll-section>
      <div class="wrapper">
        {{ content }}
      </div>
    </main>
    {%- include footer.html -%}
  </div>

  <!-- 保持其它依赖的js -->
  <script src="{{ '/assets/js/gsap.js' | relative_url }}"></script>
  <script src="{{ '/assets/js/ScrollTrigger.js' | relative_url }}"></script>
  <script src="https://cdn.jsdelivr.net/npm/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.js"></script>
  <!-- 移除原来进度条/loader动画的js逻辑，不要重复 -->
  <!-- 保留 transition.js 作为唯一过渡动画控制 -->
  <script src="{{ '/assets/js/transition.js' | relative_url }}"></script>
  <script src="{{ '/assets/js/custom.js' | relative_url }}"></script>
</body>
</html>
